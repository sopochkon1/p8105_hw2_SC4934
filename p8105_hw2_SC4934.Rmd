---
title: "p8105_hw2_SC4934"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r chunk_library, results = "hide", message = FALSE}
library(tidyverse)
library(readxl)
library(dplyr)
```



# Problem 1

## import data

```{r}
trans_ent = 
  read_csv(
    "data/chs03.csv",
    col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, vending, entrance_type, 
    ada) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```


```{r, chunk_skim, results = "hide", message = FALSE}
skimr::skim(trans_ent)
```

## description: 
the dataset `trans_ent` contains 1868 rows and 19 columns. There are 15 character, 2 logical, and 2 numeric variables. 
it includes variables: line, station_name, station_latitude, station_longitude, all the vairables that start with 
"route" (which are routes served), entry, exit_only, vending, entrance_type, and ada. 
I used `janitor::clean_names` to start the tidying process, which converts column names to lower snake case. I also used `col_types` to convert some columns to character format. I used `select` to select the variables I wanted to include, and used `mutate` to convert entry variable to logical type. 

this data is not tidy!

## distinct stations:

```{r, chunk_distint_station}
trans_ent %>% 
  select(station_name, line) %>% 
  distinct
```

After selecting only `station_name` and `line` and using the `distinct` function to obtain all unique combinations, we can see that there are 465 distinct stations.


## ADA compliance

```{r}
trans_ent %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

the chunk above filters the ADA compliant stations among all distinct stations. 
There are 84 ADA compliant stations. 

## allow entrance

```{r}
trans_ent %>% 
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
```

37.70% of station entrances/exits without vending allow entrance. 


## reformat data 

to reformat data so that route number and route name are distinct variables

```{r}
trans_ent <- trans_ent %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    values_to = "route_name")
```


to determine how many distinct stations serve the A train, and of those how many are ADA compliant: 

```{r}
trans_ent %>% 
      filter(route_name == "A")  %>% 
      select(station_name, line) %>% 
      distinct
  
trans_ent %>% 
  filter(route_name == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct

```

60 distinct stations serve the A train, and of those 17 are ADA compliant. 


# Problem 2

##import and clean Excel file

```{r}
trash_wheel = read_excel('data/Trash Wheel Collection Data.xlsx',
                                 range = 'A2:N549',
                                 sheet = "Mr. Trash Wheel",
                                 ) %>% 
  janitor::clean_names() %>% 
  mutate(
    type = "Mr Trash Wheel",
    sports_balls = as.integer(sports_balls),
    dumpster = as.character(dumpster),
  ) 


professor_wheel = read_excel('data/Trash Wheel Collection Data.xlsx',
                                 range = 'A2:M96',
                                 sheet = "Professor Trash Wheel") %>% 
  janitor::clean_names() %>% 
  mutate(
    type = "Professor Trash Wheel",
    dumpster = as.character(dumpster),
    year = as.character(year)
  ) 

```



## merge data
```{r}
mr_proff_merge <- bind_rows(trash_wheel, professor_wheel) %>% 
  janitor::clean_names()
```

Write a paragraph about these data; you are encouraged to use inline R. Be sure to note the number of observations in the resulting dataset, and give examples of key variables. For available data, what was the total weight of trash collected by Professor Trash Wheel? What was the total number of sports balls collected by Mr. Trash Wheel in 2020?

## description: 

there are 641 observations in the dataset. key variables include `dumpster`, which distinguishes dumpsters, and `type`, which shows whether the data belongs to mr. trash wheel or professor trash wheel. 


total weight of trash collected by professor trash wheel is 190.12 tons, while the total number of sports balls collected
by mr. trash wheel in 2020 is 856

```{r}
mr_proff_merge %>% 
  filter(type == "Professor Trash Wheel") %>% 
  pull(weight_tons) %>% 
  sum

mr_proff_merge %>% 
  filter(type == "Mr Trash Wheel", year == "2020") %>% 
  pull(sports_balls_int) %>% 
  sum

```



#Problem 3


```{r}
pols_month = 
  read_csv(
    "data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>% 
  mutate(
    month = month.abb[month],
    month = str_to_lower(month),
    prez_dem = na_if(prez_dem, 0) ,
    prez_gop = na_if(prez_gop, 0)
  ) %>% 
  relocate(prez_dem, .after = prez_gop) %>% 
    pivot_longer(
    prez_gop:prez_dem,
    names_to = "president",
    names_prefix = "prez_"
  ) %>% 
  select(-value, -day)
  

snp = 
  read_csv(
    "data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("month", "day", "year"), sep = "/", convert = TRUE) %>% 
  mutate(
    month = month.abb[month],
    year = ifelse(year > 49, year + 1900, year + 2000),
    month = str_to_lower(month)
  ) %>% 
  select(year, month, close)

unemployment = 
  read_csv(
    "data/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>%
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployement"
  ) 


```


## merge

```{r}
pols_snp_merge =
  left_join(snp, pols_month) %>% 
  janitor::clean_names()
  
pols_snp_unemployment = 
  left_join(unemployment, pols_snp_merge)%>% 
  janitor::clean_names()
 
```

Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).












